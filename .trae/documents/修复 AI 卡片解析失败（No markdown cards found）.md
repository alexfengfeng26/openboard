## 问题定位
- 错误来源：在 [DeepSeekChatPanel.tsx](file:///d:/workspace/claudecode/kanban-board/components/ai/DeepSeekChatPanel.tsx#L321-L402) 的 `generateDraftsFromText()`，当 AI 返回内容既不是可解析的 JSON（含/不含代码块），也不符合当前支持的 Markdown“多卡片”标题分段格式时，会抛出 `No markdown cards found`，最终显示“未能从 AI 结果中解析卡片”。
- 目前 Markdown 解析仅支持：加粗标题行（含/不含编号）、`##/###/####` 标题、以及 `- **标题**` 这种列表标题；不支持常见的 Markdown 表格、`标题：... 描述：...` 键值对样式、或 `1)`/`1）` 等变体。

## 修复目标
- 让“创建为卡片/编辑后创建”在 AI 输出不严格遵循 JSON 时也能高概率解析成功。
- 失败时提供可诊断信息与一键修复路径，避免用户只能手工补标题。

## 具体改动
### 1) 强化 JSON 提取与容错
- 新增 `extractJsonArrayFromText()`：从任意文本中定位并提取第一段合法 JSON 数组（基于括号栈/字符串状态机，避免正则误伤），支持前后夹杂解释文字的情况。
- 兼容常见“轻度污染”场景：BOM、全角引号/智能引号（“”‘’）替换为标准引号后再尝试解析（仅在不会引入歧义时应用）。
- 保持安全边界：不引入激进的“自动修复 JSON”（如随意补逗号）以免误解析成错误数据。

### 2) 扩展 Markdown 解析覆盖面
在 `parseNumberedMarkdownCards()` 现有规则外新增两类解析器（作为 parser#3 的增强或 parser#4）：
- **Markdown 表格解析**：识别 `| 标题 | 描述 |` / `| title | description |` 的表格，逐行读出行数据，忽略分隔行 `|---|---|`，生成 drafts。
- **键值对/分块解析**：支持如下常见格式：
  - `1）标题：xxx\n描述：yyy` / `1) 标题: xxx`
  - `- 标题：xxx` 后跟若干行描述
  - `任务 1：xxx` / `卡片 1：xxx`

### 3) 加一个“二次格式化”兜底（可选但推荐）
- 当所有本地解析器都失败时，自动触发一次“重排版”请求：把原始 AI 返回作为输入，再次请求模型“只输出合法 JSON 数组（严格双引号，无代码块，无解释）”。
- 为避免额外成本与循环：最多重试 1 次；若仍失败则返回错误并展示 raw。

### 4) 改善失败时的可观测性与 UX
- 在草稿面板的错误区块下方展示“原始 AI 返回内容（可折叠）”与“复制”按钮，方便用户直接把 raw 贴回去或提交 issue。
- 在错误提示里补充“期望格式示例”与常见原因（如返回了表格/列表但无加粗标题）。

### 5) 补充测试（最小可行）
- 引入 Vitest（若项目当前无测试框架）或用现有方案（若已存在）为解析函数做单元测试：
  - JSON：纯数组、代码块数组、前后夹杂文字、智能引号。
  - Markdown：加粗标题分段、`##` 标题分段、表格、`标题：/描述：` 键值对。
- 目标：保证新增解析能力不回归原有行为。

## 验证方式
- 本地构造多组 AI 返回样例，在 UI 点击“创建为卡片/编辑后创建”应能生成草稿。
- 通过单测验证解析覆盖与稳定性。

## 交付内容
- 更新后的解析/兜底逻辑（主要在 [DeepSeekChatPanel.tsx](file:///d:/workspace/claudecode/kanban-board/components/ai/DeepSeekChatPanel.tsx)）。
- 新增解析单元测试与测试脚本配置（如采用 Vitest）。